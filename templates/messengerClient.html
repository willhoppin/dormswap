<html>

  <head>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300,500,700&display=swap" rel="stylesheet" />
  </head>
  <style>
      body{
          margin: 0;
          font-family: Poppins;
      }
      
      .main-wrapper {
          background: url({{ url_for('static', filename='backgroundarrows.png') }});
          height: 100vh;
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
      }

      .feature-box {
          background: white;
          border-radius: 15px;
          height: 550px;
          width: 600px;
          box-shadow: 0px 0px 20px 0px #9BCBEB;
          display: flex;
      }

      .left-wrapper {
          width: 299px;
          height: 550px;
          border-right: 2px solid #003865;
      }

      .right-wrapper {
          width: 299px;
          height: 550px;
      }

      .header-text {
          color: #003865;
          font-weight: 500;
          font-size: 20px;
          margin: 20px;
      }

      .chat-preview-wrapper {
          display: flex;
          align-items: center;
      }

      .chat-preview-photo {
        max-height: 30px;
        max-width: 30px;
        object-fit: cover;
        border-radius: 20px;
      }

      .chat-preview-text {
          font-size: 15px;
          color:#003865;
          font-weight: 500;
          font-family: Poppins;
          margin-left: 12px;
      }

      .chat-preview-form {
          margin: 0;
      }

      .chat-preview-button {
          cursor: pointer;
          border: none;
          background: none;
          padding: 12px 20px;
          border-radius: 10px;
          background: white;
          transition: 0.2s ease-in-out;
          width: 279px;
          margin: 0 10px;
      }

      .chat-preview-button:hover {
          background: #dee7ee;
      }

      .chat-preview-selected {
          background: #003865 !important;
      }

      .chat-preview-text-selected {
          color: white !important;
      }

      .chat-preview-photo-selected {
          box-shadow: 0px 0px 10px 0px #ffffff;
      }

      .my-message-wrapper {
          background: #003865;
          margin: 0 10px 10px 110px;
          border-radius: 10px 10px 0 10px;
          padding: 10px 12px;
          width:fit-content;
          color: white;
      }

      .ext-message-wrapper {
          background: #EDF1F4;
          margin: 0 110px 10px 10px;
          padding: 10px;
          border-radius: 10px 10px 10px 0;
          width:fit-content;
          color: #003865;
      }

      .messages-wrapper {
          height: 350px;
          overflow: auto;
          border-top: 1px solid #003865;
          border-bottom: 1px solid #003865;
          display: flex;
          flex-direction: column;
          font-size: 14px;
          padding-top: 10px;
      }

      .send-message-form {
          display: flex;
          flex-direction: column;
      }

      .message-field-input {
          background: rgb(236, 236, 236);
          border-radius: 10px;
          margin: 10px 10px 0 10px;
          border: none;
          font-family: Poppins;
          height: 60px;
          padding: 5px 10px;
      }

      .message-submit-btn {
          background: #003865;
          border-radius: 10px;
          color: white;
          height: 30px;
          font-family: Poppins;
          font-weight: 500;
          border: none;
          margin: 10px;
          cursor: pointer;
          transition: 0.2s ease-in-out;
      }

      .message-submit-btn:hover {
          opacity: 0.8;
      }

  </style>

<body> 
    <div class="main-wrapper">
        <div class="feature-box">
            <div class="left-wrapper">
                <div class="header-text">
                    Your Conversations
                </div>
                {% for chat_data in all_chats %}
                    {% if other_user.user_id == chat_data[1].user_id %}
                        <form class="chat-preview-form" action="/messengerClient/{{current_user.user_id}}/{{chat_data[0].chat_id}}">
                            <button class="chat-preview-button chat-preview-selected">
                                <div class="chat-preview-wrapper">
                                    <img class="chat-preview-photo chat-preview-photo-selected" src="{{chat_data[1].photo}}" align="middle" />
                                    <div class="chat-preview-text chat-preview-text-selected">{{chat_data[1].user_name}}</div>
                                </div>
                            </button>
                        </form>
                    {% else %}
                        <form class="chat-preview-form" action="/messengerClient/{{current_user.user_id}}/{{chat_data[0].chat_id}}">
                            <button class="chat-preview-button">
                                <div class="chat-preview-wrapper">
                                    <img class="chat-preview-photo" src="{{chat_data[1].photo}}" align="middle" />
                                    <div class="chat-preview-text">{{chat_data[1].user_name}}</div>
                                </div>
                            </button>
                        </form>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="right-wrapper">
                <div class="header-text">
                    {% if other_user == [] %}
                    <i>No chat selected</i>
                    {% else %}
                    {{other_user.user_name}}
                    {% endif %}
                </div>
                <div class="messages-wrapper">
                    {% for message in messages %}
                        {% if message.sender == current_user.user_id %}
                        <div class="my-message-wrapper">
                            {{message.text}}
                        </div>
                        {% else %}
                        <div class="ext-message-wrapper">
                            {{message.text}}
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <form class="send-message-form" action="/sendMessage/{{current_user.user_id}}/{{chat_id}}">
                    <textarea class="message-field-input" placeholder="Write a message here" type="text" name="message"></textarea>
                    <input class="message-submit-btn" type="submit" value="Send">
                </form>
            </div>
        </div>
    </div>

</body>


</html>

